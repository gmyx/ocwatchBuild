import{s as H,b as D,j as V,f as y,e as E,t as v,d as N,r as R,u as w,R as F,k as S,y as G,n as C,g as J,i as A,w as I,x as z,z as Y,D as Z,E as x,F as $}from"./scheduler.D4_7AI4m.js";import{S as K,i as U,g as W,a as h,c as X,t as _,b as P,d as Q,m as q,e as M}from"./index.DeqhCWiI.js";import{n as ee,p as te,q as re,r as le,V as ae,t as B,Q as ne,g as se,b as oe,E as ue}from"./VennDiagram.svelte_svelte_type_style_lang.VCOE_R-_.js";import{Q as O}from"./inferColumnTypes.DOzp9NDw.js";function fe(n){let t,r;return t=new ae({props:{error:n[2]}}),{c(){P(t.$$.fragment)},l(e){Q(t.$$.fragment,e)},m(e,l){q(t,e,l),r=!0},p(e,l){const a={};l&4&&(a.error=e[2]),t.$set(a)},i(e){r||(_(t.$$.fragment,e),r=!0)},o(e){h(t.$$.fragment,e),r=!1},d(e){M(t,e)}}}function ce(n){let t,r=B(n[1],n[3])+"",e;return{c(){t=E("span"),e=v(r),this.h()},l(l){t=N(l,"SPAN",{style:!0});var a=R(t);e=w(a,r),a.forEach(y),this.h()},h(){F(t,"color",n[4])},m(l,a){V(l,t,a),S(t,e)},p(l,a){a&10&&r!==(r=B(l[1],l[3])+"")&&G(e,r),a&16&&F(t,"color",l[4])},i:C,o:C,d(l){l&&y(t)}}}function ie(n){let t,r,e,l,a,s="Placeholder: no data currently referenced.";return{c(){t=E("span"),r=v("["),e=v(n[0]),l=v("]"),a=E("span"),a.textContent=s,this.h()},l(u){t=N(u,"SPAN",{class:!0});var o=R(t);r=w(o,"["),e=w(o,n[0]),l=w(o,"]"),a=N(o,"SPAN",{class:!0,"data-svelte-h":!0}),J(a)!=="svelte-ddarzq"&&(a.textContent=s),o.forEach(y),this.h()},h(){A(a,"class","error-msg svelte-11norvs"),A(t,"class","placeholder svelte-11norvs")},m(u,o){V(u,t,o),S(t,r),S(t,e),S(t,l),S(t,a)},p(u,o){o&1&&G(e,u[0])},i:C,o:C,d(u){u&&y(t)}}}function me(n){let t,r,e,l;const a=[ie,ce,fe],s=[];function u(o,i){return o[0]?0:o[2]?2:1}return t=u(n),r=s[t]=a[t](n),{c(){r.c(),e=D()},l(o){r.l(o),e=D()},m(o,i){s[t].m(o,i),V(o,e,i),l=!0},p(o,[i]){let d=t;t=u(o),t===d?s[t].p(o,i):(W(),h(s[d],1,1,()=>{s[d]=null}),X(),r=s[t],r?r.p(o,i):(r=s[t]=a[t](o),r.c()),_(r,1),r.m(e.parentNode,e))},i(o){l||(_(r),l=!0)},o(o){h(r),l=!1},d(o){o&&y(e),s[t].d(o)}}}function de(n,t,r){let{data:e=null}=t,{row:l=0}=t,{column:a=null}=t,{value:s=null}=t,{placeholder:u=null}=t,{fmt:o=void 0}=t,i,d,b,{color:g=void 0}=t,f="",{redNegatives:p=!1}=t,k;return n.$$set=c=>{"data"in c&&r(5,e=c.data),"row"in c&&r(8,l=c.row),"column"in c&&r(6,a=c.column),"value"in c&&r(9,s=c.value),"placeholder"in c&&r(0,u=c.placeholder),"fmt"in c&&r(10,o=c.fmt),"color"in c&&r(11,g=c.color),"redNegatives"in c&&r(7,p=c.redNegatives)},n.$$.update=()=>{var c;if(n.$$.dirty&576&&r(6,a=a??s),n.$$.dirty&5477)try{if(r(2,b=void 0),!u)if(e){if(typeof e=="string")throw Error(`Received: data=${e}, expected: data={${e}}`);if(Array.isArray(e)||r(5,e=[e]),isNaN(l))throw Error("row must be a number (row="+l+")");try{Object.keys(e[l])[0]}catch{throw Error("Row "+l+" does not exist in the dataset")}r(6,a=a??Object.keys(e[l])[0]),ee(e,[a]),r(12,k=te(e,"array"));const j=k.filter(m=>{var T;return m.type==="date"&&!(((T=e[0])==null?void 0:T[m.id])instanceof Date)}).map(m=>m.id);for(let m=0;m<j.length;m++)r(5,e=re(e,j[m]));r(1,d=e[l][a]),r(12,k=k.filter(m=>m.id===a)),o?r(3,i=le(o,(c=k[0].format)==null?void 0:c.valueType)):r(3,i=k[0].format)}else throw Error("No data provided. If you referenced a query result, check that the name is correct.")}catch(j){r(2,b=j.message),console.error("\x1B[31m%s\x1B[0m",`Error in Value: ${b}`)}n.$$.dirty&576&&s&&a&&console.warn('Both "value" and "column" were supplied as props to Value. "value" will be ignored.'),n.$$.dirty&128&&r(7,p=p==="true"||p===!0),n.$$.dirty&2178&&(p||g)&&(p&&d<0?r(4,f="rgb(220 38 38)"):g&&r(4,f=g))},[u,d,b,i,f,e,a,p,l,s,o,g,k]}class _e extends K{constructor(t){super(),U(this,t,de,me,H,{data:5,row:8,column:6,value:9,placeholder:0,fmt:10,color:11,redNegatives:7})}}function he(n){let t;const r=n[7].default,e=Y(r,n,n[8],null);return{c(){e&&e.c()},l(l){e&&e.l(l)},m(l,a){e&&e.m(l,a),t=!0},p(l,a){e&&e.p&&(!t||a&256)&&Z(e,r,l,l[8],t?$(r,l[8],a,null):x(l[8]),null)},i(l){t||(_(e,l),t=!0)},o(l){h(e,l),t=!1},d(l){e&&e.d(l)}}}function ge(n){let t,r;const e=[n[4],{data:O.isQuery(n[11])?Array.from(n[11]):n[11]}];let l={$$slots:{default:[he]},$$scope:{ctx:n}};for(let a=0;a<e.length;a+=1)l=I(l,e[a]);return t=new _e({props:l}),{c(){P(t.$$.fragment)},l(a){Q(t.$$.fragment,a)},m(a,s){q(t,a,s),r=!0},p(a,s){const u=s&2064?se(e,[s&16&&oe(a[4]),s&2048&&{data:O.isQuery(a[11])?Array.from(a[11]):a[11]}]):{};s&256&&(u.$$scope={dirty:s,ctx:a}),t.$set(u)},i(a){r||(_(t.$$.fragment,a),r=!0)},o(a){h(t.$$.fragment,a),r=!1},d(a){M(t,a)}}}function L(n){let t,r;return t=new ue({props:{emptyMessage:n[2],emptySet:n[1],chartType:ke,isInitial:n[3]}}),{c(){P(t.$$.fragment)},l(e){Q(t.$$.fragment,e)},m(e,l){q(t,e,l),r=!0},p(e,l){const a={};l&4&&(a.emptyMessage=e[2]),l&2&&(a.emptySet=e[1]),l&8&&(a.isInitial=e[3]),t.$set(a)},i(e){r||(_(t.$$.fragment,e),r=!0)},o(e){h(t.$$.fragment,e),r=!1},d(e){M(t,e)}}}function ye(n){let t,r,e=!n[4].placeholder&&L(n);return{c(){t=E("span"),e&&e.c(),this.h()},l(l){t=N(l,"SPAN",{slot:!0});var a=R(t);e&&e.l(a),a.forEach(y),this.h()},h(){A(t,"slot","empty")},m(l,a){V(l,t,a),e&&e.m(t,null),r=!0},p(l,a){l[4].placeholder?e&&(W(),h(e,1,1,()=>{e=null}),X()):e?(e.p(l,a),a&16&&_(e,1)):(e=L(l),e.c(),_(e,1),e.m(t,null))},i(l){r||(_(e),r=!0)},o(l){h(e),r=!1},d(l){l&&y(t),e&&e.d()}}}function be(n){let t,r="Loading...";return{c(){t=E("span"),t.textContent=r,this.h()},l(e){t=N(e,"SPAN",{slot:!0,class:!0,"data-svelte-h":!0}),J(t)!=="svelte-exu0be"&&(t.textContent=r),this.h()},h(){A(t,"slot","skeleton"),A(t,"class","text-gray-500")},m(e,l){V(e,t,l)},p:C,d(e){e&&y(t)}}}function pe(n){let t,r;return t=new ne({props:{data:n[0],$$slots:{skeleton:[be],empty:[ye],default:[ge,({loaded:e})=>({11:e}),({loaded:e})=>e?2048:0]},$$scope:{ctx:n}}}),{c(){P(t.$$.fragment)},l(e){Q(t.$$.fragment,e)},m(e,l){q(t,e,l),r=!0},p(e,[l]){const a={};l&1&&(a.data=e[0]),l&2334&&(a.$$scope={dirty:l,ctx:e}),t.$set(a)},i(e){r||(_(t.$$.fragment,e),r=!0)},o(e){h(t.$$.fragment,e),r=!1},d(e){M(t,e)}}}let ke="Value";function Se(n,t,r){let e,{$$slots:l={},$$scope:a}=t,{data:s}=t,{column:u}=t,{agg:o}=t;const i=O.isQuery(s)?s.hash:void 0;let d=(s==null?void 0:s.hash)===i,{emptySet:b=void 0}=t,{emptyMessage:g=void 0}=t;return n.$$set=f=>{r(10,t=I(I({},t),z(f))),"data"in f&&r(0,s=f.data),"column"in f&&r(5,u=f.column),"agg"in f&&r(6,o=f.agg),"emptySet"in f&&r(1,b=f.emptySet),"emptyMessage"in f&&r(2,g=f.emptyMessage),"$$scope"in f&&r(8,a=f.$$scope)},n.$$.update=()=>{n.$$.dirty&97&&o&&r(0,s=s.groupBy(void 0).agg({[o]:{col:u,as:u}})),n.$$.dirty&1&&r(3,d=(s==null?void 0:s.hash)===i),r(4,e=Object.fromEntries(Object.entries(t).filter(([,f])=>f!==void 0)))},t=z(t),[s,b,g,d,e,u,o,l,a]}class Ve extends K{constructor(t){super(),U(this,t,Se,pe,H,{data:0,column:5,agg:6,emptySet:1,emptyMessage:2})}}export{Ve as V};
